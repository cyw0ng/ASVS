# 附录 C: 物联网设备验证需求

本章节原先处于验证标准的主体之中，但基于 OWASP IoT 团队已经完成了该项工作的情况，已经没有必要在该领域上独立跟踪两套不同的标准。在 4.0 发布版本，我们将它移动到了附录，对于需要该领域标准的使用者，请参阅[OWASP IoT 项目](https://owasp.org/www-project-internet-of-things/)。

## 控制目标

嵌入式及物联网设备应满足：

* 通过在可信标准下强制实施的安全控制，使其具备与服务器设备相同的安全控制水准。
* 储存于设备上的敏感数据应位于安全环境内，如 SE（安全元素，Secure Element）中。
* 所有于设备间传送的敏感数据应使用已使能传输层安全的新到信道。

## 安全验证需求

| # | 描述 | L1 | L2 | L3 | 需求引入版本 |
| --- | --- | --- | --- | -- | -- |
| **C.1** | 验证应用层调试接口，如 USB、UART 及其他串口类接入方式均被关闭或已使能复杂的密码保护。 | ✓ | ✓ | ✓ | 4.0 |
| **C.2** | 验证每台设备所使用的密码学相关的密钥及证书是独特的。 | ✓ | ✓ | ✓ | 4.0 |
| **C.3** | 验证内存安全的相关控制，如 ASLR 及 DEP 在嵌入式或 IoT 设备支持的情况下，已被使能。 | ✓ | ✓ | ✓ | 4.0 |
| **C.4** | 验证片上的调试借口，如 JTAG 或 SWD 等已被关闭或存在已使能保护措施，且相关措施已被正确配置。 | ✓ | ✓ | ✓ | 4.0 |
| **C.5** | 验证可信执行环境在 SoC 或 CPU 支持的情况下已被实现或使能。 | ✓ | ✓ | ✓ | 4.0 |
| **C.6** | 验证敏感数据、私钥和证书等被以安全的方式存储于 SE（安全元素，Secure Element）、TPM（可信平台模块，Trusted Platform Module）、TEE（可信执行环境，Trusted Execution Environment）中或已被应用密码学意义上的强保护方式。 | ✓ | ✓ | ✓ | 4.0 |
| **C.7** | 验证固件应用通过使能传输层安全协议以保护处于信道中的数据。 | ✓ | ✓ | ✓ | 4.0 |
| **C.8** | 验证固件应用验证其与服务器通信使用的数字证书。 | ✓ | ✓ | ✓ | 4.0 |
| **C.9** | 验证无限通信网络行为已使能双向认证。 | ✓ | ✓ | ✓ | 4.0 |
| **C.10** | 验证无线通信行为发生于加密信道上。  | ✓ | ✓ | ✓ | 4.0 |
| **C.11** | 验证任何已被禁止使用的 C 函数已被使用安全的等价函数替代。 | ✓ | ✓ | ✓ | 4.0 |
| **C.12** | 验证每个固件组件具备对三方组分、版本及已披露漏洞的，基于软件的管理方式。 | ✓ | ✓ | ✓ | 4.0 |
| **C.13** | 验证所有代码，包含三方提供的二进制、库及框架等已被实施面向硬编码身份凭据（后门）的检视。 | ✓ | ✓ | ✓ | 4.0 |
| **C.14** | 验证应用及固件组分可免于 OS 命令注入攻击，如通过调用 shell 命令的包装、脚本等，或存在安全控制以阻断 OS 命令注入。 | ✓ | ✓ | ✓ | 4.0 |
| **C.15** | 验证固件应用的数字签名绑定于可信的服务器。 |  | ✓ | ✓ | 4.0 |
| **C.16** | 验证抗干扰或干扰检测功能。 |  | ✓ | ✓ | 4.0 |
| **C.17** | 验证任何由芯片厂商提供的知识产权保护技术已被使能。 |  | ✓ | ✓ | 4.0 |
| **C.18** | 验证存在用于增强固件逆向难度的安全控制（如移除详细的调试符号）。 |  | ✓ | ✓ | 4.0 |
| **C.19** | 验证设备在加载前已对启动镜像实施了验证。 |  | ✓ | ✓ | 4.0 |
| **C.20** | 验证固件升级过程不存在可被利用的 TOCTOU 型漏洞。 |  | ✓ | ✓ | 4.0 |
| **C.21** | 验证设备已使用代码签名并在安装固件升级文件前对其进行了验证。 |  | ✓ | ✓ | 4.0 |
| **C.22** | 验证设备不能被降级至旧版本的有效固件（防回滚）。 |  | ✓ | ✓ | 4.0 |
| **C.23** | 验证嵌入式设备已使用密码学意义上安全的伪随机数生成器（如使用芯片提供的随机数生成器）。 |  | ✓ | ✓ | 4.0 |
| **C.24** | 验证固件可以通过一个预先设定的计划实施自动更新。 |  | ✓ | ✓ | 4.0 |
| **C.25** | 验证设备在检测到干扰或收到无效的信心时可清除固件及敏感数据。 |  |  | ✓ | 4.0 |
| **C.26** | 验证设备仅使用了可关闭调试接口（如 JTAG、SWD 等）的微控制器。 |  |  | ✓ | 4.0 |
| **C.27** | 验证设备近使用了对芯片开封和侧信道攻击提供防护的微控制器。 |  |  | ✓ | 4.0 |
| **C.28** | 验证敏感轨迹不被暴露于 PCB 板的外层。|  |  | ✓ | 4.0 |
| **C.29** | 验证片间（如主板与挂载于主板上的其他设备板间）通信是加密的。 |  |  | ✓ | 4.0 |
| **C.30** | 验证设备使用了代码签名并在实际执行前实施验证。 |  |  | ✓ | 4.0 |
| **C.31** | 验证内存中保有的敏感数据在无需使用时被立刻主动以 0 覆写。 |  |  | ✓ | 4.0 |
| **C.32** | 验证固件内应用使用内核容器隔离。 |  |  | ✓ | 4.0 |
| **C.33** | 验证安全编译选项，如 -fPIE, -fstack-protector-all, -Wl,-z,noexecstack, -Wl,-z,noexecheap 等已在固件的构建过程中使能。 |  |  | ✓ | 4.0 |
| **C.34** | 验证微控制器在支持的情况下已被配置了执行代码保护。 |  |  | ✓ | 4.0 |

## 参考文献

更多的本领域相关内容，请参阅：

* [OWASP Internet of Things Top 10](https://owasp.org/www-pdf-archive/OWASP-IoT-Top-10-2018-final.pdf)
* [OWASP Embedded Application Security Project](https://owasp.org/www-project-embedded-application-security/)
* [OWASP Internet of Things Project](https://owasp.org/www-project-internet-of-things/)
* [Trudy TCP Proxy Tool](https://github.com/praetorian-inc/trudy)
