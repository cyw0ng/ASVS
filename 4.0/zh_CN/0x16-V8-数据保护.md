# V8: 数据保护验证需求

## 控制目标

对于数据保护存在三个关键点：机密性（Confidentiality），完整性（Integrity）和可用性（Availability）。本标准假设数据保护已在可信的系统上被使能，如服务器平台等，这样的系统应已经被加固并具备足够的保护。

应用必须去假设所有的用户设备已被以某种方式突破。当应用在不安全的设备（如共享的计算机、手机或平板设备等）传输或保存敏感数据，应用需对保证该设备上的数据被加密并不能被攻击者轻易的获得篡改或暴露。

保证被验证的应用满足如下的高阶数据保护需求：

* 机密性: 数据应被保护，以免受在传输或存储时未授权的观察或披露。
* 完整性: 数据应被保护，以免受未被授权的供给者实施可疑的创建、修改或删除。
* 可用性: 数据应对于已被授权的用户可用。

## V8.1 宏观数据保护

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.1.1** | 验证应用保护其数据不被缓存于服务器的相关组件（如负载均衡器及应用缓存）中。 | | ✓ | ✓ | 524 |
| **8.1.2** | 验证所有的服务器上的缓存及临时的敏感数据拷贝已应用保护，以免受攻击者在授权用户处理数据后，实施未授权的访问、删除或无效化。 | | ✓ | ✓ | 524 |
| **8.1.3** | 验证应用最小化了其在请求中的参数，如隐藏字段、Ajax 变量、cookies 及存在于 header 中的值。 | | ✓ | ✓ | 233 |
| **8.1.4** | 验证应用可检测并报警异常的用户请求数量，如 IP、用户、以每小时或每天为单位的、以及任何对系统有意义的度量值。 | | ✓ | ✓ | 770 |
| **8.1.5** | 验证系统具备对重要数据的常规性备份行为，并实施对数据恢复能力的测试。 | | | ✓ | 19 |
| **8.1.6** | 验证备份被安全的存储，以保护数据不被窃取或损坏。 | | | ✓ | 19 |

## V8.2 用户侧数据保护

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.2.1** | 验证应用在 header 中是能力足够的禁止缓存标识，以防止敏感数据被缓存于现代浏览器中。 | ✓ | ✓ | ✓ | 525 |
| **8.2.2** | 验证浏览器存储（如 HTML5 local storage、session storage、IndexedDB 或 cookies 等）中不包含敏感数据或 PII（个人可识别信息，Personally identifiable information）。 | ✓ | ✓ | ✓ | 922 |
| **8.2.3** | 验证在客户端或会话被终止时，认证后的数据应被从客户端存储（如浏览器 DOM 等）中清除。 | ✓ | ✓ | ✓ | 922 |

## V8.3 敏感隐私数据

本章节帮助保护敏感数据，以使其免受未授权的创建、阅读、更新或删除等，尤其是在大量的情况下。

遵守本章节需求暗示了遵守 V4 访问控制章节中的需求，尤其是对于 V4.2 章节。例如，为保护个人信息不被实施未授权的更新或暴露，需满足 V4.2.1。请同时遵守本章节及 V4 章节以达到全面的覆盖。

注：隐私相关的法律法规，如 Australian Privacy Principles APP-11 或 GDPR 等，直接影响应用必须实现的，对敏感数据存储、使用和传输的方式。违反的后果涵盖简答的提示至严重的惩罚。请参阅产品所在地的本地法律法规，并在需要的情况下咨询有资质的隐私专家或律师。

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **8.3.1** | 验证发送至服务端的敏感数据存在于 HTTP 消息体或 header 中，且 query string 参数中不包含任何敏感数据。 | ✓ | ✓ | ✓ | 319 |
| **8.3.2** | 验证用户具备方法以在需要时移除或导出其个人数据。 | ✓ | ✓ | ✓ | 212 |
| **8.3.3** | 验证用户被以明确的语言提供了对其个人数据的采集及使用范围，同时在任何数据被使用前，应经用户主动同意。 | ✓ | ✓ | ✓ | 285 |
| **8.3.4** | 验证所有的敏感数据 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 200 |
| **8.3.4** | 验证应用所有敏感数据的创建和处理被正确识别，并保证存在对敏感数据的处理策略。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 200 |
| **8.3.5** | 验证对敏感数据的访问，当数据被访问或需要进行访问日志记录时，是被审计（并非将敏感数据本身写入 log）的。 | | ✓ | ✓ | 532 |
| **8.3.6** | 验证内存中的敏感信息当其不再需要时被立刻以 0 或随机值覆写，以缓解内存 dump 攻击。 | | ✓ | ✓ | 226 |
| **8.3.7** | 验证需被加密的敏感信息或个人数据，被通过合理的算法加密，以满足机密性及完整性需求。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | | ✓ | ✓ | 327 |
| **8.3.8** | 验证敏感的个人信息被通过有效的数据留存机制限制，旧的或过时的数据应有计划的、或在某些条件下被自动清除。 | | ✓ | ✓ | 285 |

当考虑数据保护时，主要的考虑应围绕规模化提取、修改或超限使用。例如，许多社交媒体系统仅允许用户每天添加 100 个新好友，但这样的请求来源于何种系统并不重要。一个银行平台可能希望阻断在每小时内超过 5 次的，单次额度超过 1000 欧元的对外部机构的交易事务。每个体系的需求均是不相同的，所以对非正常行为的识别必须考虑威胁建模及业务风险。重要的水准为，对批量的非正常的请求的发现、决断或有条件的阻断。

## 参考文献

更多的本领域相关内容，请参阅：

* [Consider using Security Headers website to check security and anti-caching headers](https://securityheaders.io)
* [OWASP Secure Headers project](https://owasp.org/www-project-secure-headers/)
* [OWASP Privacy Risks Project](https://owasp.org/www-project-top-10-privacy-risks/)
* [OWASP User Privacy Protection Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html)
* [European Union General Data Protection Regulation (GDPR) overview](https://edps.europa.eu/data-protection_en)
* [European Union Data Protection Supervisor - Internet Privacy Engineering Network](https://edps.europa.eu/data-protection/ipen-internet-privacy-engineering-network_en)
