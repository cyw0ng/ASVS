# V4: 访问控制验证需求

## 控制目标

授权（Authorization）是一个形容实体仅允许访问其被授权访问的资源的概念。一个被验证的应用应满足如下的高阶需求：

* 访问资源的人员具备相应有效的身份标示。
* 用户被关联至被良好定义的角色和特权的集合。
* 角色和授权的元数据被实施了防重放及防干扰保护。

## 安全验证需求

## V4.1 宏观访问控制设计

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **4.1.1** | 验证应用在可信的服务层面上强制使用了访问控制策略，尤其在客户侧访问控制可能被绕过的情况下。 | ✓ | ✓ | ✓ | 602 |
| **4.1.2** | 验证所有用于访问控制的用户及数据属性和策略信息，在未被明确授权下无法被最终用户操作。 | ✓ | ✓ | ✓ | 639 |
| **4.1.3** | 验证系统应用了最小权限原则 - 用户应仅能对于他们已被明确授权的函数、数据文件、URL、控制器、服务以及其他服务等实施访问。该保护策略可用于预防欺骗（spoofing）或提权。 ([C7](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ |  285 |
| **4.1.4** | 验证系统应用了默认拒绝准则，当新用户或角色被创建时应仅具备最小、甚至无权限，且用户或角色在未被明确授权前不得访问系统的新功能。  ([C7](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ |  276 |
| **4.1.5** | 验证访问控制在发生异常时安全的失败。 ([C10](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ |  285 |

## V4.2 微观访问控制设计

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **4.2.1** | 验证敏感数据及 API 被实施保护以预防面向创建、读取、更新或删除记录的 IDOR （不安全的直接对象访问，Insecure Direct Object Reference）攻击，如创建或更新其他用户的记录、获取各用户的记录或删除全部记录。 | ✓ | ✓ | ✓ | 639 |
| **4.2.2** | 验证应用或框架已使能了足够强度的反 CSRF 机制以保护需认证的功能，以及使能有效的反自动化或反 CSRF 机制以保护认证前即使能的功能。 | ✓ | ✓ | ✓ | 352 |

## V4.3 其他访问控制相关考虑项

| # | 描述 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **4.3.1** | 验证管理接口已使能了恰当的多因子认证以阻断未经授权的使用。 | ✓ | ✓ | ✓ | 419 |
| **4.3.2** | 验证基于文件体系的浏览功能在并非一定需要时已被关闭。额外的，应用不应暴露包含元信息的文件或路径，如 Thumbs.db、.DS_Store 及 .git、.svn 等路径。 | ✓ | ✓ | ✓ | 548 |
| **4.3.3** | 验证应用对其底层系统访问具备额外的认证（如步进式或适应性的）机制，或在上层应用间应用职责分离，以实现逐应用维度的反欺诈控制。 |  | ✓ | ✓ |  732 |

## 参考文献

更多的本领域相关内容，请参阅：

* [OWASP Testing Guide 4.0: Authorization](https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/05-Authorization_Testing/README.html)
* [OWASP Cheat Sheet: Access Control](https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html)
* [OWASP CSRF Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
* [OWASP REST Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html)
